<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hazmat Tactical Tool - Training Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ff6b35;
            --secondary: #00d9ff;
            --danger: #ff3838;
            --success: #00ff88;
            --warning: #ffd23f;
            --bg-dark: #0a0e1a;
            --bg-card: #141824;
            --bg-elevated: #1a1f2e;
            --border: #2a3144;
            --text: #e8eaed;
            --text-muted: #8b95a8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1f2e 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 53, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 217, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        /* HEADER */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 14, 26, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: 20px;
            margin: -20px -20px 30px -20px;
        }
        
        .brand {
            font-family: 'Rajdhani', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        
        .tagline {
            font-size: 0.85rem;
            color: var(--text-muted);
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        /* SCBA TIMER */
        .timer-card {
            background: linear-gradient(135deg, rgba(255, 56, 56, 0.1) 0%, rgba(255, 56, 56, 0.05) 100%);
            border: 2px solid var(--danger);
            border-radius: 16px;
            padding: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(255, 56, 56, 0.2);
            position: relative;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .timer-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 56, 56, 0.1) 0%, transparent 70%);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        #timerDisplay {
            font-family: 'Rajdhani', monospace;
            font-size: 3rem;
            font-weight: 700;
            color: var(--danger);
            text-shadow: 0 0 20px rgba(255, 56, 56, 0.5);
            position: relative;
            z-index: 1;
            letter-spacing: 4px;
        }
        
        .timer-controls {
            display: flex;
            gap: 12px;
            position: relative;
            z-index: 1;
        }
        
        .timer-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .timer-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 56, 56, 0.3);
        }
        
        /* SECTION HEADERS */
        .section-header {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin: 40px 0 20px 0;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-header::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(to bottom, var(--primary), transparent);
        }
        
        /* CARDS */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 24px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 53, 0.3), transparent);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 107, 53, 0.3);
        }
        
        /* INPUTS */
        input, select {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: 'Inter', sans-serif;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
            background: var(--bg-card);
        }
        
        input::placeholder {
            color: var(--text-muted);
        }
        
        label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        /* CHEMICAL RESULTS */
        .chem-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .chem-name {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--warning) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 6px;
            font-family: 'Rajdhani', sans-serif;
            letter-spacing: 1px;
        }
        
        .chem-meta {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        /* BADGES */
        .badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 4px;
        }
        
        .badge-ppe {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .badge-sink {
            background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
            color: white;
        }
        
        .badge-float {
            background: linear-gradient(135deg, #00d9ff 0%, #0099cc 100%);
            color: white;
        }
        
        /* DATA GRID */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .data-cell {
            background: var(--bg-elevated);
            padding: 16px;
            border-radius: 10px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .data-cell:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .data-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .data-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            font-family: 'Rajdhani', sans-serif;
        }
        
        /* COMPASS */
        .plume-container {
            display: flex;
            align-items: center;
            gap: 24px;
            margin-top: 16px;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }
        
        #compass {
            width: 100px;
            height: 100px;
            border: 3px solid var(--border);
            border-radius: 50%;
            position: relative;
            background: radial-gradient(circle, #1a1f2e, #0a0e1a);
            flex-shrink: 0;
        }
        
        #plumeArrow {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 45px;
            background: linear-gradient(to top, transparent, var(--danger));
            transform-origin: top;
            transform: translate(-50%, 0) rotate(180deg);
            transition: transform 0.3s ease;
        }
        
        .compass-label {
            position: absolute;
            font-size: 11px;
            color: #666;
            font-weight: bold;
        }
        
        .compass-n {
            top: 4px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        /* STATUS BOXES */
        .status-box {
            padding: 16px;
            border-radius: 10px;
            font-weight: 600;
            margin-top: 12px;
            border: 1px solid transparent;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .behavior-out {
            background: rgba(0, 217, 255, 0.1);
            color: var(--secondary);
            border-color: var(--secondary);
        }
        
        .meter-alert {
            background: rgba(255, 56, 56, 0.1);
            color: var(--danger);
            border-color: var(--danger);
        }
        
        /* SEARCH RESULTS */
        .search-results {
            max-height: 240px;
            overflow-y: auto;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            margin-top: 8px;
            border-radius: 10px;
        }
        
        .search-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: all 0.2s ease;
        }
        
        .search-item:hover {
            background: rgba(255, 107, 53, 0.1);
            padding-left: 20px;
        }
        
        .search-item:last-child {
            border-bottom: none;
        }
        
        /* GRID HELPERS */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        /* DOWNLOAD CARDS */
        .download-card {
            transition: all 0.3s ease;
        }
        
        .download-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        /* EMERGENCY BUTTON */
        .btn-emergency {
            display: block;
            width: 100%;
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: white;
            text-align: center;
            padding: 16px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            margin-top: 32px;
            box-shadow: 0 4px 16px rgba(183, 28, 28, 0.4);
            transition: all 0.3s ease;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }
        
        .btn-emergency:hover {
            background: linear-gradient(135deg, #d32f2f 0%, #f44336 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(183, 28, 28, 0.5);
        }
        
        /* FOOTER */
        .footer {
            text-align: center;
            margin-top: 16px;
            padding: 20px;
            font-size: 0.75rem;
            color: var(--text-muted);
            border-top: 1px solid var(--border);
        }
        
        /* MOBILE RESPONSIVE */
        @media (max-width: 768px) {
            .brand {
                font-size: 1.8rem;
            }
            
            #timerDisplay {
                font-size: 2.2rem;
            }
            
            .timer-controls {
                flex-direction: column;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .plume-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="brand">üî• HAZMAT TACTICAL TOOL</div>
        <div class="tagline">Professional Training Platform</div>
        
        <div class="timer-card">
            <div id="timerDisplay">00:00:00</div>
            <div class="timer-controls">
                <button class="timer-btn" onclick="toggleTimer()" id="timerCtrl">START ENTRY</button>
                <button class="timer-btn" onclick="resetTimer()">RESET</button>
            </div>
        </div>
    </div>

    <div class="section-header">üî¨ Chemical Identification</div>
    <div class="card">
        <input type="text" id="chemSearch" placeholder="Search by Name or UN Number (e.g., Chlorine or 1017)..." oninput="processSearch()">
        <div id="searchResults" class="search-results" style="display:none;"></div>
        <div id="resultArea" style="display:none;">
            <div class="chem-header">
                <div>
                    <div id="outName" class="chem-name"></div>
                    <div class="chem-meta">UN <span id="outUN"></span> | <span id="outType"></span></div>
                </div>
                <div id="ppeBadge" class="badge badge-ppe"></div>
            </div>
            
            <div style="display: flex; gap: 8px; margin: 12px 0;">
                <span id="airBadge" class="badge"></span>
                <span id="waterBadge" class="badge"></span>
            </div>

            <div class="data-grid">
                <div class="data-cell">
                    <div class="data-label">REL (NIOSH)</div>
                    <div class="data-value" id="outREL">--</div>
                </div>
                <div class="data-cell">
                    <div class="data-label">TWA</div>
                    <div class="data-value" id="outTWA">--</div>
                </div>
                <div class="data-cell">
                    <div class="data-label">STEL</div>
                    <div class="data-value" id="outSTEL">--</div>
                </div>
                <div class="data-cell">
                    <div class="data-label">IDLH</div>
                    <div class="data-value" id="outIDLH">--</div>
                </div>
                <div class="data-cell">
                    <div class="data-label">VD (Air=1)</div>
                    <div class="data-value" id="outVD">--</div>
                </div>
                <div class="data-cell">
                    <div class="data-label">SG (H‚ÇÇO=1)</div>
                    <div class="data-value" id="outSG">--</div>
                </div>
            </div>

            <div style="margin-top:24px; border-top: 1px solid var(--border); padding-top:16px;">
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:var(--success); font-weight:700; margin-bottom:12px;">
                    <span>ERG ISOLATION DISTANCE</span>
                    <span id="isoInitDisp" style="color: #fff;"></span>
                </div>
                
                <div class="plume-container">
                    <div id="compass">
                        <div class="compass-label compass-n">N</div>
                        <div id="plumeArrow"></div>
                    </div>
                    <div style="flex-grow: 1;">
                        <label>Wind From: <span id="windDeg" style="color: #fff;">180</span>¬∞</label>
                        <input type="range" id="windSlider" min="0" max="360" value="180" oninput="updatePlume()">
                        <div style="font-size: 0.85rem; margin-top: 12px;">
                            <span style="color: var(--danger);">Downwind Protection Zone:</span> <span id="isoDownDisp" style="font-weight:700; color:#fff;">--</span>
                        </div>
                        <div style="margin-top: 16px; padding: 12px; background: rgba(0, 217, 255, 0.1); border-radius: 8px; border: 1px solid rgba(0, 217, 255, 0.3);">
                            <div style="font-size: 0.75rem; color: var(--secondary); font-weight: 700; margin-bottom: 6px;">üí° POSITIONING GUIDE:</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted); line-height: 1.6;">
                                <span style="color: var(--success);">‚úì UPWIND:</span> Safe zone - Position command post here<br>
                                <span style="color: var(--warning);">‚ö† CROSSWIND:</span> Caution zone - Monitor for wind shift<br>
                                <span style="color: var(--danger);">‚úó DOWNWIND:</span> Danger zone - Evacuate protection distance
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grid-2" style="margin-top: 16px;">
                    <select id="spillSize" onchange="updateIso()">
                        <option value="small">Small Spill (&lt;55 gal)</option>
                        <option value="large">Large Spill (&gt;55 gal)</option>
                    </select>
                    <select id="timeDay" onchange="updateIso()">
                        <option value="day">Daytime</option>
                        <option value="night">Nighttime</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="section-header">üî¨ VOC Correction Factor (PID)</div>
    <div class="card">
        <p style="color: var(--text-muted); margin-bottom: 20px;">PIDs are calibrated to isobutylene. Use correction factors to get true chemical concentration.</p>
        
        <div class="grid-2">
            <div>
                <label>Select Chemical</label>
                <select id="vocChemical" onchange="updateVocCalc()">
                    <option value="">-- Select Chemical --</option>
                </select>
            </div>
            <div>
                <label>PID Reading (ppm)</label>
                <input type="number" id="pidReading" placeholder="e.g., 50" oninput="updateVocCalc()" min="0" step="0.1">
            </div>
        </div>
        
        <div id="vocResult" class="status-box behavior-out" style="display:none; margin-top: 16px; text-align: center;">
            <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 8px;">Corrected Reading: <span id="vocCorrected" style="color: var(--primary);">--</span> ppm</div>
            <div style="font-size: 0.85rem; color: var(--text-muted);">
                Calculation: <span id="vocCalcShow">--</span>
            </div>
        </div>
        
        <div style="margin-top: 20px; padding: 16px; background: rgba(255, 107, 53, 0.05); border-radius: 10px; border: 1px solid rgba(255, 107, 53, 0.3);">
            <div style="font-size: 0.75rem; color: var(--primary); font-weight: 700; margin-bottom: 8px;">üí° HOW TO USE:</div>
            <div style="font-size: 0.85rem; color: var(--text-muted); line-height: 1.6;">
                1. Read your PID (calibrated to isobutylene)<br>
                2. Select the chemical you're monitoring<br>
                3. Enter your PID reading<br>
                4. The calculator shows TRUE concentration<br>
                <br>
                <strong style="color: var(--primary);">Example:</strong> Gasoline spill reads 50 ppm. CF = 2.1. True concentration = 50 √ó 2.1 = 105 ppm
            </div>
        </div>
    </div>

    <div class="section-header">üí• LEL to PPM Converter</div>
    <div class="card">
        <p style="color: var(--text-muted); margin-bottom: 20px;">Convert LEL% readings to actual ppm concentration. Remember: Products are TOXIC before they're EXPLOSIVE.</p>
        
        <div class="grid-2">
            <div>
                <label>Select Chemical</label>
                <select id="lelChemical" onchange="updateLelCalc()">
                    <option value="">-- Select Chemical --</option>
                </select>
            </div>
            <div>
                <label>LEL Meter Reading (%)</label>
                <input type="number" id="lelReading" placeholder="e.g., 10" oninput="updateLelCalc()" min="0" max="100" step="0.1">
            </div>
        </div>
        
        <div id="lelResult" class="status-box" style="display:none; margin-top: 16px;">
            <div style="font-size: 1.2rem; font-weight: 700; margin-bottom: 8px;">
                Actual Concentration: <span id="lelActual" style="color: var(--primary);">--</span> ppm
            </div>
            <div style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px;">
                Calculation: <span id="lelCalcShow">--</span>
            </div>
            <div id="lelToxicWarning" style="display:none; padding: 12px; background: rgba(255, 56, 56, 0.1); border-radius: 8px; border: 1px solid var(--danger); margin-top: 12px;">
                <div style="font-size: 0.9rem; color: var(--danger); font-weight: 700;">‚ö†Ô∏è TOXIC HAZARD</div>
                <div style="font-size: 0.85rem; color: var(--text-muted); margin-top: 4px;" id="lelToxicText">--</div>
            </div>
        </div>
        
        <div style="margin-top: 20px; padding: 16px; background: rgba(255, 56, 56, 0.05); border-radius: 10px; border: 1px solid rgba(255, 56, 56, 0.3);">
            <div style="font-size: 0.75rem; color: var(--danger); font-weight: 700; margin-bottom: 8px;">üî• CRITICAL TRAINING POINT:</div>
            <div style="font-size: 0.85rem; color: var(--text-muted); line-height: 1.6;">
                <strong style="color: var(--danger);">Chemicals are TOXIC before they're EXPLOSIVE!</strong><br>
                <br>
                Example: Gasoline<br>
                ‚Ä¢ Toxic at ~300 ppm (health hazard)<br>
                ‚Ä¢ 10% LEL = 1,400 ppm (still below explosive range)<br>
                ‚Ä¢ 100% LEL = 14,000 ppm (explosive range)<br>
                <br>
                <strong>Lesson:</strong> Even "low" LEL readings can be serious toxic hazards!
            </div>
        </div>
    </div>

    <div class="section-header">üìä Behavioral Modeling (GEBMO)</div>
    <div class="card">
        <label>Release Type / Container Stress</label>
        <select id="stressType" onchange="runBehavior()">
            <option value="">-- Select Situation --</option>
            <option value="mechanical">Mechanical Stress (Puncture/Crack)</option>
            <option value="thermal">Thermal Stress (Fire/Heat Impingement)</option>
            <option value="chemical">Chemical Stress (Reaction/Corrosion)</option>
        </select>
        <div id="behaviorResult" class="status-box behavior-out" style="display:none;"></div>
    </div>

    <div class="section-header">üå°Ô∏è Air Monitoring & Meter Alarms</div>
    <div class="card">
        <select id="meterSel" onchange="updateMeter()">
            <option value="">-- Select Meter --</option>
            <option value="multirae">MultiRAE (5-Gas)</option>
            <option value="altair">Altair 5x</option>
            <option value="pid">PID (VOCs)</option>
            <option value="ppb">PPB Meter</option>
            <option value="sensit">Sensit Gas Meter</option>
            <option value="nh3">Ammonia Meter</option>
            <option value="cl2">Chlorine Meter</option>
            <option value="hcn">Cyanide Meter</option>
            <option value="prd">PRD (Gamma)</option>
            <option value="ludlum">Ludlum (Alpha/Beta/Gamma)</option>
        </select>
        <div id="meterDisplay" style="display:none; margin-top:16px;">
            <div style="overflow-x: auto;">
                <table style="width:100%; border-collapse: collapse;">
                    <thead>
                        <tr style="border-bottom: 2px solid var(--border);">
                            <th style="text-align:left; padding:12px; color:var(--text-muted); font-size:0.75rem; text-transform:uppercase; letter-spacing:1px;">Sensor</th>
                            <th style="text-align:left; padding:12px; color:var(--text-muted); font-size:0.75rem; text-transform:uppercase; letter-spacing:1px;">Low Alarm</th>
                            <th style="text-align:left; padding:12px; color:var(--text-muted); font-size:0.75rem; text-transform:uppercase; letter-spacing:1px;">High Alarm</th>
                        </tr>
                    </thead>
                    <tbody id="meterBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="section-header">‚ò¢Ô∏è Radiation: Inverse Square Law</div>
    <div class="card">
        <label>Calculation Mode</label>
        <select id="radMode" onchange="updateRadMode()">
            <option value="distance">Find Safe Distance (I know dose, need distance)</option>
            <option value="dose">Find Dose at Distance (I know distance, need dose)</option>
            <option value="source">Calculate Source Strength (Estimate hazard)</option>
        </select>
        
        <div id="radInputs" style="margin-top:16px;"></div>
        
        <div id="radResult" class="status-box behavior-out" style="text-align: center;">Select mode and enter values</div>
        
        <div style="margin-top: 16px; padding: 16px; background: rgba(0, 0, 0, 0.3); border-radius: 10px; font-size: 0.75rem; color: var(--text-muted);">
            <strong style="color: var(--secondary);">üí° How to use:</strong>
            <div id="radHelp" style="margin-top: 8px;">Select a calculation mode above to see instructions</div>
        </div>
    </div>

    <div class="section-header">‚öóÔ∏è Reactivity Check</div>
    <div class="card">
        <div class="grid-2">
            <div>
                <label>Chemical A</label>
                <select id="chemA" onchange="checkReact()">
                    <option value="">-- Select --</option>
                </select>
            </div>
            <div>
                <label>Chemical B</label>
                <select id="chemB" onchange="checkReact()">
                    <option value="">-- Select --</option>
                </select>
            </div>
        </div>
        <div id="reactOut" class="status-box meter-alert" style="display:none;"></div>
    </div>

    <div class="section-header">üõ¢Ô∏è Containment Compatibility</div>
    <div class="card">
        <label>Product Type</label>
        <select id="containType" onchange="updateContainment()">
            <option value="">-- Select Product Type --</option>
            <option value="Acid">Acid (pH &lt; 7)</option>
            <option value="Base">Base (pH &gt; 7)</option>
            <option value="Oxidizer">Oxidizer</option>
            <option value="Flammable">Flammable Liquid/Gas</option>
            <option value="Poison">Poison/Toxic</option>
            <option value="Cyanide">Cyanide Compound</option>
            <option value="Solvent">Chlorinated Solvent</option>
            <option value="Inert">Inert/Low Hazard</option>
            <option value="Cryogenic">Cryogenic</option>
            <option value="Radioactive">Radioactive Material</option>
        </select>
        
        <div id="containResult" style="display:none; margin-top: 20px;">
            <div style="background: rgba(0, 255, 136, 0.05); padding: 16px; border-radius: 10px; margin-bottom: 12px; border: 1px solid var(--success);">
                <div style="font-size: 0.8rem; color: var(--success); font-weight: 700; margin-bottom: 10px;">‚úÖ COMPATIBLE OPTIONS</div>
                <div id="containCompatible" style="font-size: 0.9rem; line-height: 1.8;"></div>
            </div>
            
            <div style="background: rgba(255, 56, 56, 0.05); padding: 16px; border-radius: 10px; margin-bottom: 12px; border: 1px solid var(--danger);">
                <div style="font-size: 0.8rem; color: var(--danger); font-weight: 700; margin-bottom: 10px;">‚õî AVOID / INCOMPATIBLE</div>
                <div id="containAvoid" style="font-size: 0.9rem; line-height: 1.8; color: #ff8a80;"></div>
            </div>
            
            <div style="background: rgba(0, 217, 255, 0.05); padding: 16px; border-radius: 10px; border: 1px solid var(--secondary);">
                <div style="font-size: 0.8rem; color: var(--secondary); font-weight: 700; margin-bottom: 10px;">üí° FIELD TIPS</div>
                <div id="containTips" style="font-size: 0.9rem; line-height: 1.8; color: #80d8ff;"></div>
            </div>
        </div>
    </div>

    <a href="tel:18004249300" class="btn-emergency">üö® CALL CHEMTREC (1-800-424-9300)</a>
    
    <div class="footer">
        <strong>Hazmat Tactical Tool v1.0</strong><br>
        Data: NIOSH Pocket Guide & ERG 2024 | Training Tool Only - Not for Field Use
    </div>
</div>

<script>
    /* COMPREHENSIVE CHEMICAL DATABASE - NIOSH & ERG 2024 */
    const chemicals = [
        // TOXIC GASES
        { name: "Chlorine", un: "1017", vd: 2.5, sg: 1.56, ppe: "A", rel: "C 0.5 ppm", twa: "0.5 ppm", stel: "1 ppm", idlh: "10 ppm", type: "Oxidizer", smallIso: ["200 ft", "0.2 mi", "0.5 mi"], largeIso: ["1000 ft", "2.1 mi", "5.0 mi"] },
        { name: "Ammonia, Anhydrous", un: "1005", vd: 0.6, sg: 0.7, ppe: "B", rel: "25 ppm", twa: "25 ppm", stel: "35 ppm", idlh: "300 ppm", type: "Base", smallIso: ["100 ft", "0.1 mi", "0.2 mi"], largeIso: ["500 ft", "0.5 mi", "1.4 mi"] },
        { name: "Phosgene", un: "1076", vd: 3.4, sg: 1.37, ppe: "A", rel: "C 0.1 ppm", twa: "0.1 ppm", stel: "N.D.", idlh: "2 ppm", type: "Poison", smallIso: ["200 ft", "0.6 mi", "1.9 mi"], largeIso: ["1500 ft", "3.8 mi", "7+ mi"] },
        { name: "Hydrogen Cyanide", un: "1051", vd: 0.94, sg: 0.69, ppe: "A", rel: "C 4.7 ppm", twa: "4.7 ppm", stel: "N.D.", idlh: "50 ppm", type: "Cyanide", smallIso: ["500 ft", "0.7 mi", "2.1 mi"], largeIso: ["2000 ft", "4.1 mi", "6.2 mi"] },
        { name: "Chlorine Dioxide", un: "9191", vd: 2.3, sg: 1.6, ppe: "A", rel: "0.1 ppm", twa: "0.1 ppm", stel: "0.3 ppm", idlh: "5 ppm", type: "Oxidizer", smallIso: ["200 ft", "0.3 mi", "1.0 mi"], largeIso: ["800 ft", "1.7 mi", "4.5 mi"] },
        
        // CORROSIVES
        { name: "Sulfuric Acid", un: "1830", vd: 3.4, sg: 1.84, ppe: "A", rel: "1 mg/m¬≥", twa: "1 mg/m¬≥", stel: "N.D.", idlh: "15 mg/m¬≥", type: "Acid", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Hydrochloric Acid", un: "1789", vd: 1.3, sg: 1.18, ppe: "B", rel: "C 5 ppm", twa: "5 ppm", stel: "N.D.", idlh: "50 ppm", type: "Acid", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "0.1 mi", "0.4 mi"] },
        { name: "Nitric Acid", un: "2031", vd: 2.2, sg: 1.5, ppe: "A", rel: "2 ppm", twa: "2 ppm", stel: "4 ppm", idlh: "25 ppm", type: "Acid", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Hydrofluoric Acid", un: "1790", vd: 0.7, sg: 1.15, ppe: "A", rel: "C 3 ppm", twa: "3 ppm", stel: "N.D.", idlh: "30 ppm", type: "Acid", smallIso: ["150 ft", "0.1 mi", "0.2 mi"], largeIso: ["500 ft", "0.6 mi", "1.2 mi"] },
        { name: "Phosphoric Acid", un: "1805", vd: 3.4, sg: 1.87, ppe: "B", rel: "1 mg/m¬≥", twa: "1 mg/m¬≥", stel: "3 mg/m¬≥", idlh: "1000 mg/m¬≥", type: "Acid", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Acetic Acid", un: "2789", vd: 2.1, sg: 1.05, ppe: "B", rel: "10 ppm", twa: "10 ppm", stel: "15 ppm", idlh: "50 ppm", type: "Acid", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Sodium Hydroxide", un: "1823", vd: "N/A", sg: 2.13, ppe: "B", rel: "C 2 mg/m¬≥", twa: "2 mg/m¬≥", stel: "N.D.", idlh: "10 mg/m¬≥", type: "Base", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        
        // FLAMMABLES
        { name: "Benzene", un: "1114", vd: 2.8, sg: 0.88, ppe: "B", rel: "C 0.1 ppm", twa: "0.1 ppm", stel: "1 ppm", idlh: "500 ppm", type: "Flammable", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Ethanol", un: "1170", vd: 1.6, sg: 0.79, ppe: "B", rel: "1000 ppm", twa: "1000 ppm", stel: "N.D.", idlh: "3300 ppm", type: "Flammable", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Methanol", un: "1230", vd: 1.1, sg: 0.79, ppe: "B", rel: "200 ppm", twa: "200 ppm", stel: "250 ppm", idlh: "6000 ppm", type: "Flammable", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Acetone", un: "1090", vd: 2.0, sg: 0.79, ppe: "B", rel: "250 ppm", twa: "250 ppm", stel: "N.D.", idlh: "2500 ppm", type: "Flammable", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        { name: "Toluene", un: "1294", vd: 3.1, sg: 0.87, ppe: "B", rel: "100 ppm", twa: "100 ppm", stel: "150 ppm", idlh: "500 ppm", type: "Flammable", smallIso: ["150 ft", "N/A", "N/A"], largeIso: ["330 ft", "N/A", "N/A"] },
        
        // COMPRESSED GASES
        { name: "Methane", un: "1971", vd: 0.6, sg: "N/A", ppe: "B", rel: "N.E.", twa: "N.E.", stel: "N.E.", idlh: "N.D.", type: "Flammable", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        { name: "Propane", un: "1978", vd: 1.6, sg: "N/A", ppe: "B", rel: "1000 ppm", twa: "1000 ppm", stel: "N.D.", idlh: "2100 ppm", type: "Flammable", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        { name: "Oxygen", un: "1072", vd: 1.1, sg: 1.14, ppe: "B", rel: "N.E.", twa: "N.E.", stel: "N.E.", idlh: "N.D.", type: "Oxidizer", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        { name: "Nitrogen", un: "1066", vd: 1.0, sg: 0.81, ppe: "B", rel: "N.E.", twa: "N.E.", stel: "N.E.", idlh: "N.D.", type: "Inert", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        { name: "Hydrogen", un: "1049", vd: 0.07, sg: "N/A", ppe: "B", rel: "N.E.", twa: "N.E.", stel: "N.E.", idlh: "N.D.", type: "Flammable", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        { name: "Carbon Dioxide", un: "1013", vd: 1.5, sg: "N/A", ppe: "B", rel: "5000 ppm", twa: "5000 ppm", stel: "30000 ppm", idlh: "40000 ppm", type: "Inert", smallIso: ["N/A", "N/A", "N/A"], largeIso: ["N/A", "N/A", "N/A"] },
        
        // RADIOACTIVE
        { name: "Technetium-99m", un: "2911", vd: "N/A", sg: "N/A", ppe: "Rad", rel: "Rad", twa: "Rad", stel: "Rad", idlh: "Rad", type: "Radioactive", smallIso: ["See Rad", "See Rad", "See Rad"], largeIso: ["See Rad", "See Rad", "See Rad"] },
        { name: "Iodine-131", un: "2910", vd: "N/A", sg: "N/A", ppe: "Rad", rel: "Rad", twa: "Rad", stel: "Rad", idlh: "Rad", type: "Radioactive", smallIso: ["See Rad", "See Rad", "See Rad"], largeIso: ["See Rad", "See Rad", "See Rad"] },
        { name: "Cobalt-60", un: "2912", vd: "N/A", sg: "N/A", ppe: "Rad", rel: "Rad", twa: "Rad", stel: "Rad", idlh: "Rad", type: "Radioactive", smallIso: ["See Rad", "See Rad", "See Rad"], largeIso: ["See Rad", "See Rad", "See Rad"] },
        { name: "Cesium-137", un: "2912", vd: "N/A", sg: "N/A", ppe: "Rad", rel: "Rad", twa: "Rad", stel: "Rad", idlh: "Rad", type: "Radioactive", smallIso: ["See Rad", "See Rad", "See Rad"], largeIso: ["See Rad", "See Rad", "See Rad"] }
    ];

    const vocCorrectionFactors = {
        "Acetaldehyde": 1.8, "Acetic acid": 3.4, "Acetyl anhydride": 2.0, "Acetone": 2.2,
        "Acetylene": 2.8, "Allyl Alcohol": 1.7, "Ammonia": 0.8, "Aniline": 3.0,
        "Benzene": 2.2, "Butadiene, 1,3-": 2.5, "Butane, n-": 2.0, "Butane, i-": 1.8,
        "Butanol, n-": 3.0, "Butanol, i-": 2.5, "Butanol, t-": 1.8, "Butene, 1": 2.1,
        "Butene, 2 cis": 2.1, "Butene, 2 trans": 1.9, "Butyric acid": 2.4,
        "Carbon disulfide": 3.2, "Carbon monoxide": 1.2, "Carbonyl sulfide": 1.0,
        "Chlorobenzene": 3.0, "Chloroethane": 1.7, "Chloroform": 1.0, "Chloropro pane, 1-": 1.8,
        "Cyanogen": 1.1, "Cyclohexane": 2.5, "Cyclopropane": 1.8, "Decane, n-": 3.4,
        "Dichloroethane, 1,2-": 1.5, "Dichloromethane": 1.0, "Diesel": "use PID",
        "Dimethylbutane": 2.7, "Dimethyl pentane, 2,3-": 2.3, "Dimethyl sulfide": 2.3,
        "Dioxane, 1,4-": 2.5, "Ethane": 1.4, "Ethanol": 1.7, "Ethene": 1.4,
        "Ethyl acetate": 2.2, "Ethylamine": 1.4, "Ethyl benzene": 2.8, "Ethyl bromide": 0.9,
        "Ethyl chloride": 1.7, "Ethyl ether": 2.3, "Ethyl formate": 2.4, "Ethyl mercaptan": 1.8,
        "Ethyl methyl ether": 2.3, "Ethyl sec": 2.4, "Ethylene oxide": 2.3, "Gasoline": 2.1,
        "Heptane, n-": 2.4, "Hexadiene, 1,4-": 1.5, "Hexane, n-": 2.3, "Hydrazine": 2.1,
        "Hydrogen": 1.1, "Hydrogen cyanide": 2.0, "Hydrogen sulfide": 3.2, "Isobutylene": 1.5,
        "Isopropanol": 2.6, "Jet fuel, JP4, JP5, JP8": "use PID", "Methane": 1.0,
        "Methanol": 1.5, "Methyl acetate": 2.2, "Methylamine": 1.3, "Methyl bromide": 1.1,
        "Methyl chloride": 1.3, "Methylcyclohexane": 2.6, "Methyl ether": 1.7,
        "Methyl ethyl ketone": 2.6, "Methyl formate": 1.9, "Methyl hexane": 2.4,
        "Methyl mercaptan": 1.6, "Methyl pentane": 2.7, "Methyl propyl ketone": 2.7,
        "Methyl n-propyl ketone": 2.7, "Napthalene": 2.9, "Nitromethane": 1.0,
        "Nonane, n-": 3.2, "Octane, n-": 2.9, "Pentane, n-": 2.2, "Pentane, i-": 2.3,
        "Pentane, neo-": 2.5, "Pentene, l-": 2.3, "Phosphine": 0.3, "Propane": 1.6,
        "Propanol, n-": 2.0, "Propene": 1.6, "Propylene, n-": 2.1, "Propylene oxide": 2.6,
        "Propyl ether, i-": 2.3, "Propyne": 2.3, "Toluene": 2.6, "Triethylamine": 2.5,
        "Trimethylamine": 1.9, "Trimethylbutane": 2.3, "Turpentine": 2.9, "Vinyl chloride": 1.8,
        "Xylene, m-": 2.7, "Xylene, o-": 3.0, "Xylene, p-": 2.8
    };

    const lelValues = {
        // Format: { lel: LEL in ppm, toxic: typical toxic threshold for comparison }
        "Gasoline": { lel: 14000, toxic: 300, idlh: 1000 },
        "Propane": { lel: 21000, toxic: 1000, idlh: 2100 },
        "Methane": { lel: 50000, toxic: "N/A", idlh: "N/A" },
        "Benzene": { lel: 12000, toxic: 10, idlh: 500 },
        "Toluene": { lel: 12000, toxic: 100, idlh: 500 },
        "Xylene": { lel: 10000, toxic: 100, idlh: 900 },
        "Acetone": { lel: 25000, toxic: 250, idlh: 2500 },
        "Methanol": { lel: 60000, toxic: 200, idlh: 6000 },
        "Ethanol": { lel: 33000, toxic: 1000, idlh: 3300 },
        "Isopropanol": { lel: 20000, toxic: 400, idlh: 2000 },
        "Hexane": { lel: 12000, toxic: 50, idlh: 1100 },
        "Heptane": { lel: 11000, toxic: 400, idlh: 750 },
        "Octane": { lel: 10000, toxic: 300, idlh: 1000 },
        "Butane": { lel: 18000, toxic: 800, idlh: 1600 },
        "Pentane": { lel: 14000, toxic: 600, idlh: 1500 },
        "Ethyl acetate": { lel: 20000, toxic: 400, idlh: 2000 },
        "Acetaldehyde": { lel: 40000, toxic: 100, idlh: 2000 },
        "Hydrogen": { lel: 40000, toxic: "N/A", idlh: "N/A" },
        "Carbon monoxide": { lel: 125000, toxic: 35, idlh: 1200 },
        "Ammonia": { lel: 150000, toxic: 25, idlh: 300 },
        "Hydrogen sulfide": { lel: 40000, toxic: 10, idlh: 100 },
        "Styrene": { lel: 11000, toxic: 50, idlh: 700 },
        "MEK (Methyl Ethyl Ketone)": { lel: 18000, toxic: 200, idlh: 3000 },
        "Cyclohexane": { lel: 13000, toxic: 300, idlh: 1300 }
    };

    const meters = {
        multirae: [{s:"O‚ÇÇ", l:"19.5%", h:"23.5%"}, {s:"LEL", l:"10%", h:"20%"}, {s:"CO", l:"35 ppm", h:"200 ppm"}, {s:"H‚ÇÇS", l:"10 ppm", h:"20 ppm"}],
        altair: [{s:"O‚ÇÇ", l:"19.5%", h:"23.0%"}, {s:"LEL", l:"10%", h:"20%"}, {s:"CO", l:"25 ppm", h:"100 ppm"}, {s:"H‚ÇÇS", l:"10 ppm", h:"15 ppm"}],
        pid: [{s:"VOC", l:"10 ppm", h:"100 ppm"}],
        ppb: [{s:"VOC (Low)", l:"500 ppb", h:"5000 ppb"}],
        sensit: [{s:"Combustible", l:"10% LEL", h:"25% LEL"}],
        nh3: [{s:"Ammonia", l:"25 ppm", h:"50 ppm"}],
        cl2: [{s:"Chlorine", l:"0.5 ppm", h:"1.0 ppm"}],
        hcn: [{s:"Cyanide", l:"4.7 ppm", h:"10 ppm"}],
        prd: [{s:"Gamma", l:"50 ¬µR/hr", h:"2 mR/hr"}],
        ludlum: [{s:"Alpha/Beta", l:"Check Bkg", h:"2x Bkg"}, {s:"Gamma", l:"0.5 mR/hr", h:"5 mR/hr"}]
    };

    const reactMatrix = { 
        "Acid+Base": "üî• VIOLENT NEUTRALIZATION: Produces intense heat & splatter risk.",
        "Base+Acid": "üî• VIOLENT NEUTRALIZATION: Produces intense heat & splatter risk.",
        "Acid+Cyanide": "üíÄ LETHAL GAS: Generates Hydrogen Cyanide (HCN) gas! Immediate evacuation!",
        "Cyanide+Acid": "üíÄ LETHAL GAS: Generates Hydrogen Cyanide (HCN) gas! Immediate evacuation!",
        "Oxidizer+Flammable": "üí• EXPLOSION RISK: Violent deflagration or detonation possible.",
        "Flammable+Oxidizer": "üí• EXPLOSION RISK: Violent deflagration or detonation possible.",
        "Acid+Oxidizer": "‚ö†Ô∏è FIRE RISK: May ignite combustibles; produces heat.",
        "Oxidizer+Acid": "‚ö†Ô∏è FIRE RISK: May ignite combustibles; produces heat."
    };

    const containmentData = {
        "Acid": {
            compatible: [
                "<strong>Overpacks:</strong> Poly drums (HDPE), Glass carboys (if intact)",
                "<strong>Plugs:</strong> Teflon, EPDM rubber, Acid-resistant epoxy",
                "<strong>Patches:</strong> Acid-resistant putty, Specialized tape",
                "<strong>Absorbents:</strong> Acid neutralizers (soda ash), Poly pads"
            ],
            avoid: [
                "Steel or aluminum containers (corrosion)",
                "Natural rubber seals (degradation)",
                "Reactive bases nearby (neutralization hazard)",
                "Cyanide salts (HCN gas generation)"
            ],
            tips: [
                "Acids heavier than water generally sink - check SG",
                "Dilute acid into water, NEVER water into acid",
                "Neutralize with soda ash or lime before disposal",
                "Monitor vapor generation - use wet towels for suppression"
            ]
        },
        "Base": {
            compatible: [
                "<strong>Overpacks:</strong> Poly drums, Stainless steel (for some bases)",
                "<strong>Plugs:</strong> Neoprene, Viton, EPDM rubber",
                "<strong>Patches:</strong> Base-resistant epoxy, Specialized tape",
                "<strong>Absorbents:</strong> Base neutralizers (citric acid), Poly pads"
            ],
            avoid: [
                "Aluminum (reacts violently with NaOH)",
                "Acids nearby (neutralization hazard)",
                "Glass containers (etching risk with strong bases)",
                "Natural fibers (cellulose degradation)"
            ],
            tips: [
                "Bases usually heavier than water - will sink",
                "Slippery when wet - indicates contamination",
                "Neutralize with citric acid or vinegar before disposal",
                "Protective eyewear critical - causes blindness"
            ]
        },
        "Oxidizer": {
            compatible: [
                "<strong>Containers:</strong> Stainless steel, Specialized poly (verify compatibility)",
                "<strong>Patches:</strong> Metal patches only - no organics",
                "<strong>Handling:</strong> Keep cool, prevent contamination"
            ],
            avoid: [
                "All combustibles (paper, wood, cloth)",
                "Flammable liquids or gases",
                "Reducing agents",
                "Heat sources"
            ],
            tips: [
                "Oxidizers don't burn - they make other things burn BETTER",
                "Even a small amount on cloth can cause spontaneous combustion",
                "Decon with copious water - dilution is key",
                "Keep away from ALL organic materials"
            ]
        },
        "Flammable": {
            compatible: [
                "<strong>Containers:</strong> Steel drums (grounded), Approved safety cans",
                "<strong>Patches:</strong> Metal patches, Nonsparking tools",
                "<strong>Absorbents:</strong> Vermiculite, Poly pads, Sand"
            ],
            avoid: [
                "Ignition sources (flames, sparks, static)",
                "Oxidizers",
                "Heat or direct sunlight",
                "Plastic containers (static buildup)"
            ],
            tips: [
                "Ground all containers before transfer",
                "Vapor density > 1 means vapors sink and travel",
                "Eliminate ignition sources 50+ feet away",
                "Use explosion-proof equipment only"
            ]
        },
        "Cyanide": {
            compatible: [
                "<strong>Containers:</strong> Poly drums, Stainless steel",
                "<strong>Handling:</strong> Cyanide antidote kit on-scene",
                "<strong>Decon:</strong> Sodium hypochlorite solution (pH >10)"
            ],
            avoid: [
                "ALL acids (generates HCN gas)",
                "Heat (accelerates HCN release)",
                "Moisture with dry cyanides (vapor generation)"
            ],
            tips: [
                "CRITICAL: Keep away from all acids - fatal gas risk",
                "Have cyanide antidote kit on-scene (amyl nitrite, sodium nitrite)",
                "Wet cyanide salts can generate HCN vapor",
                "Alkaline conditions stabilize cyanides",
                "Oxidize with bleach solution (pH >10) for decon"
            ]
        },
        "Inert": {
            compatible: [
                "<strong>Overpacks:</strong> Any - Steel, Poly, Fiber drums all acceptable",
                "<strong>Plugs:</strong> Wood, Rubber, Plastic - most materials work",
                "<strong>Patches:</strong> Duct tape, Epoxy, Rubber patches"
            ],
            avoid: [
                "Over-complicating simple solutions"
            ],
            tips: [
                "Standard spill response procedures apply",
                "Good opportunity for training new team members",
                "Still use PPE - 'inert' doesn't mean 'safe'"
            ]
        },
        "Cryogenic": {
            compatible: [
                "<strong>Containers:</strong> Dewar flasks, Cryogenic cylinders only",
                "<strong>Handling:</strong> Cryogenic gloves, Face shields"
            ],
            avoid: [
                "Regular containers - will crack/shatter",
                "Direct skin contact - instant frostbite",
                "Sealed containers - pressure buildup"
            ],
            tips: [
                "Liquid expands 700x when warming - asphyxiation hazard",
                "Allow controlled venting - don't seal",
                "O‚ÇÇ deficiency monitoring critical",
                "LOX + organics = fire/explosion risk"
            ]
        },
        "Radioactive": {
            compatible: [
                "<strong>Containers:</strong> Lead pigs, Steel drums with lead lining",
                "<strong>Shielding:</strong> Lead sheets, Concrete barriers",
                "<strong>Containment:</strong> Double-bag in poly"
            ],
            avoid: [
                "Unshielded handling",
                "Unnecessary time near source",
                "Contamination spread"
            ],
            tips: [
                "Time, Distance, Shielding - apply all three",
                "Continuous dose monitoring required",
                "Establish contamination control zones",
                "Medical isotopes: Usually low energy, short half-life"
            ]
        }
    };

    /* TIMER FUNCTIONS */
    let timerInt, secs = 0, running = false;
    function toggleTimer() {
        const b = document.getElementById('timerCtrl');
        if(!running){
            timerInt = setInterval(() => {
                secs++;
                let h=Math.floor(secs/3600).toString().padStart(2,'0');
                let m=Math.floor((secs%3600)/60).toString().padStart(2,'0');
                let s=(secs%60).toString().padStart(2,'0');
                document.getElementById('timerDisplay').innerText = `${h}:${m}:${s}`;
                
                if(secs === 600) alert("‚ö†Ô∏è 10 minutes elapsed - Check air supply!");
                if(secs === 1200) alert("‚ö†Ô∏è 20 minutes elapsed - Consider exit!");
                if(secs === 1500) alert("üö® 25 minutes elapsed - EXIT NOW!");
            }, 1000);
            b.innerText = "STOP ENTRY"; running = true;
        } else { 
            clearInterval(timerInt); 
            b.innerText = "RESUME"; 
            running = false; 
        }
    }
    
    function resetTimer() { 
        clearInterval(timerInt); 
        secs=0; 
        running=false; 
        document.getElementById('timerDisplay').innerText="00:00:00"; 
        document.getElementById('timerCtrl').innerText="START ENTRY"; 
    }

    /* SEARCH FUNCTIONS */
    let currentMatch = null;
    let searchResults = [];
    
    function processSearch() {
        const q = document.getElementById('chemSearch').value.toLowerCase().trim();
        const resultsDiv = document.getElementById('searchResults');
        const area = document.getElementById('resultArea');
        
        if(q.length < 2) { 
            resultsDiv.style.display = 'none'; 
            area.style.display = 'none'; 
            searchResults = [];
            return; 
        }
        
        searchResults = chemicals.filter(c => 
            c.name.toLowerCase().includes(q) || 
            c.un.includes(q)
        );
        
        if(searchResults.length === 0) {
            resultsDiv.style.display = 'none';
            area.style.display = 'none';
        } else if(searchResults.length === 1) {
            selectChemical(searchResults[0]);
            resultsDiv.style.display = 'none';
        } else {
            resultsDiv.innerHTML = searchResults.map(c => 
                `<div class="search-item" onclick="selectChemical(chemicals.find(ch => ch.un === '${c.un}'))">${c.name} (UN ${c.un})</div>`
            ).join('');
            resultsDiv.style.display = 'block';
            area.style.display = 'none';
        }
    }
    
    function selectChemical(chem) {
        currentMatch = chem;
        document.getElementById('searchResults').style.display = 'none';
        document.getElementById('resultArea').style.display = 'block';
        
        document.getElementById('outName').innerText = chem.name;
        document.getElementById('outUN').innerText = chem.un;
        document.getElementById('outType').innerText = chem.type;
        document.getElementById('outREL').innerText = chem.rel;
        document.getElementById('outTWA').innerText = chem.twa || "N.D.";
        document.getElementById('outSTEL').innerText = chem.stel || "N.D.";
        document.getElementById('outIDLH').innerText = chem.idlh;
        document.getElementById('outVD').innerText = chem.vd === "N/A" ? "N/A" : chem.vd;
        document.getElementById('outSG').innerText = chem.sg === "N/A" ? "N/A" : chem.sg;
        document.getElementById('ppeBadge').innerText = "PPE: " + chem.ppe;
        
        if(chem.vd === "N/A") {
            document.getElementById('airBadge').className = "badge";
            document.getElementById('airBadge').innerText = "VD: N/A";
            document.getElementById('airBadge').style.background = "#444";
        } else if(chem.vd > 1) {
            document.getElementById('airBadge').className = "badge badge-sink";
            document.getElementById('airBadge').innerText = "VD: Sinks";
        } else {
            document.getElementById('airBadge').className = "badge badge-float";
            document.getElementById('airBadge').innerText = "VD: Rises";
        }
        
        if(chem.sg === "N/A") {
            document.getElementById('waterBadge').className = "badge";
            document.getElementById('waterBadge').innerText = "SG: N/A";
            document.getElementById('waterBadge').style.background = "#444";
        } else if(chem.sg > 1) {
            document.getElementById('waterBadge').className = "badge badge-sink";
            document.getElementById('waterBadge').innerText = "SG: Sinks";
        } else {
            document.getElementById('waterBadge').className = "badge badge-float";
            document.getElementById('waterBadge').innerText = "SG: Floats";
        }
        
        updateIso();
        runBehavior();
    }

    function updateIso() {
        if(!currentMatch) return;
        const d = document.getElementById('spillSize').value === 'small' ? currentMatch.smallIso : currentMatch.largeIso;
        document.getElementById('isoInitDisp').innerText = "INIT: " + d[0];
        document.getElementById('isoDownDisp').innerText = (document.getElementById('timeDay').value === 'day') ? d[1] : d[2];
    }

    function updatePlume() {
        const deg = document.getElementById('windSlider').value;
        document.getElementById('windDeg').innerText = deg;
        document.getElementById('plumeArrow').style.transform = `translate(-50%, 0) rotate(${parseInt(deg)+180}deg)`;
    }

    function runBehavior() {
        if(!currentMatch) return;
        const stress = document.getElementById('stressType').value;
        const out = document.getElementById('behaviorResult');
        if(!stress) { out.style.display = 'none'; return; }
        
        out.style.display = 'block';
        let msg = `[BEHAVIOR] For ${currentMatch.name}: `;
        
        if(currentMatch.vd !== "N/A") {
            if(currentMatch.vd > 1) msg += "Vapors will pool in low areas/basements. ";
            else msg += "Vapors will rise and dissipate upward. ";
        }
        
        if(stress === 'thermal') {
            msg += "Thermal stress will increase internal pressure, risking BLEVE or rapid catastrophic breach.";
        } else if(stress === 'mechanical') {
            msg += "Mechanical damage suggests localized breach; expect stream or spray release.";
        } else if(stress === 'chemical') {
            msg += "Chemical attack may cause corrosion or material weakening; monitor for unusual degradation.";
        }
        out.innerText = msg;
    }

    function updateMeter() {
        const m = document.getElementById('meterSel').value;
        const b = document.getElementById('meterBody');
        const d = document.getElementById('meterDisplay');
        if(!m || !meters[m]) { d.style.display = 'none'; return; }
        
        b.innerHTML = "";
        meters[m].forEach(i => { 
            b.innerHTML += `<tr style="border-bottom:1px solid var(--border);"><td style="padding:12px; font-weight:600;">${i.s}</td><td style="padding:12px;">${i.l}</td><td style="padding:12px;">${i.h}</td></tr>`; 
        });
        d.style.display = 'block';
    }

    function updateRadMode() {
        const mode = document.getElementById('radMode').value;
        const inputsDiv = document.getElementById('radInputs');
        const helpDiv = document.getElementById('radHelp');
        
        if(mode === 'distance') {
            inputsDiv.innerHTML = `
                <div class="grid-2">
                    <div>
                        <label>Measured Dose (mR/hr)</label>
                        <input type="number" id="radInput1" placeholder="e.g. 100" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                    <div>
                        <label>At Distance (feet)</label>
                        <input type="number" id="radInput2" placeholder="e.g. 2" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                </div>
                <label>Target Safe Dose (mR/hr)</label>
                <input type="number" id="radInput3" placeholder="e.g. 5" oninput="calcRadMode()" min="0" step="0.1">
            `;
            helpDiv.innerHTML = `<strong>Example:</strong> I measured 100 mR/hr at 2 feet. To get down to 5 mR/hr, how far back? ‚Üí Answer: 8.9 feet`;
        } else if(mode === 'dose') {
            inputsDiv.innerHTML = `
                <div class="grid-2">
                    <div>
                        <label>Known Dose (mR/hr)</label>
                        <input type="number" id="radInput1" placeholder="e.g. 10" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                    <div>
                        <label>Current Distance (feet)</label>
                        <input type="number" id="radInput2" placeholder="e.g. 20" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                </div>
                <label>New Distance (feet)</label>
                <input type="number" id="radInput3" placeholder="e.g. 5" oninput="calcRadMode()" min="0" step="0.1">
            `;
            helpDiv.innerHTML = `<strong>Example:</strong> I'm at 20 feet reading 10 mR/hr. If I move to 5 feet, what dose? ‚Üí Answer: 160 mR/hr`;
        } else if(mode === 'source') {
            inputsDiv.innerHTML = `
                <div class="grid-2">
                    <div>
                        <label>Measured Dose (mR/hr)</label>
                        <input type="number" id="radInput1" placeholder="e.g. 10" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                    <div>
                        <label>At Distance (feet)</label>
                        <input type="number" id="radInput2" placeholder="e.g. 20" oninput="calcRadMode()" min="0" step="0.1">
                    </div>
                </div>
            `;
            helpDiv.innerHTML = `<strong>Example:</strong> I measured 10 mR/hr at 20 feet. What's the source strength? ‚Üí Answer: 4000 mR/hr at 1 ft`;
        }
        
        document.getElementById('radResult').innerText = "Enter values to calculate";
    }
    
    function calcRadMode() {
        const mode = document.getElementById('radMode').value;
        const val1 = parseFloat(document.getElementById('radInput1').value);
        const val2 = parseFloat(document.getElementById('radInput2').value);
        const out = document.getElementById('radResult');
        
        if(mode === 'distance') {
            const val3 = parseFloat(document.getElementById('radInput3').value);
            
            if(val1 && val2 && val3 && val1 > 0 && val2 > 0 && val3 > 0) {
                if(val3 > val1) {
                    out.innerText = "‚ö†Ô∏è Target dose cannot exceed measured dose!";
                    out.className = "status-box meter-alert";
                    return;
                }
                const result = Math.sqrt((val1 * Math.pow(val2, 2)) / val3);
                out.innerText = `‚úì Safe Distance: ${result.toFixed(1)} feet`;
                out.className = "status-box behavior-out";
            }
        } else if(mode === 'dose') {
            const val3 = parseFloat(document.getElementById('radInput3').value);
            
            if(val1 && val2 && val3 && val1 > 0 && val2 > 0 && val3 > 0) {
                const result = (val1 * Math.pow(val2, 2)) / Math.pow(val3, 2);
                out.innerText = `üìä Dose at ${val3} ft: ${result.toFixed(1)} mR/hr`;
                
                if(result > 100) {
                    out.className = "status-box meter-alert";
                } else {
                    out.className = "status-box behavior-out";
                }
            }
        } else if(mode === 'source') {
            if(val1 && val2 && val1 > 0 && val2 > 0) {
                const result = val1 * Math.pow(val2, 2);
                let category = "";
                
                if(result < 100) category = " (Low - likely medical isotope)";
                else if(result < 1000) category = " (Medium - medical/industrial)";
                else if(result < 10000) category = " (High - industrial source)";
                else category = " (Very High - major source!)";
                
                out.innerText = `üéØ Source Strength at 1 ft: ${result.toFixed(0)} mR/hr${category}`;
                out.className = "status-box behavior-out";
            }
        }
    }
    
    window.addEventListener('DOMContentLoaded', function() {
        updateRadMode();
        
        // Populate VOC correction factor dropdown
        const vocSelect = document.getElementById('vocChemical');
        Object.keys(vocCorrectionFactors).sort().forEach(chem => {
            const option = document.createElement('option');
            option.value = chem;
            option.textContent = chem;
            vocSelect.appendChild(option);
        });
        
        // Populate LEL converter dropdown
        const lelSelect = document.getElementById('lelChemical');
        Object.keys(lelValues).sort().forEach(chem => {
            const option = document.createElement('option');
            option.value = chem;
            option.textContent = chem;
            lelSelect.appendChild(option);
        });
    });

    function updateVocCalc() {
        const chemical = document.getElementById('vocChemical').value;
        const reading = parseFloat(document.getElementById('pidReading').value);
        const resultDiv = document.getElementById('vocResult');
        const correctedSpan = document.getElementById('vocCorrected');
        const calcShow = document.getElementById('vocCalcShow');
        
        if(!chemical || !reading || reading <= 0) {
            resultDiv.style.display = 'none';
            return;
        }
        
        const cf = vocCorrectionFactors[chemical];
        
        if(cf === "use PID") {
            resultDiv.style.display = 'block';
            correctedSpan.innerText = reading.toFixed(1);
            calcShow.innerText = `No correction needed - use PID reading as-is`;
            return;
        }
        
        const corrected = reading * cf;
        resultDiv.style.display = 'block';
        correctedSpan.innerText = corrected.toFixed(1);
        calcShow.innerText = `${reading} ppm √ó ${cf} = ${corrected.toFixed(1)} ppm`;
    }

    function updateLelCalc() {
        const chemical = document.getElementById('lelChemical').value;
        const lelPercent = parseFloat(document.getElementById('lelReading').value);
        const resultDiv = document.getElementById('lelResult');
        const actualSpan = document.getElementById('lelActual');
        const calcShow = document.getElementById('lelCalcShow');
        const warningDiv = document.getElementById('lelToxicWarning');
        const warningText = document.getElementById('lelToxicText');
        
        if(!chemical || !lelPercent || lelPercent <= 0) {
            resultDiv.style.display = 'none';
            return;
        }
        
        const data = lelValues[chemical];
        const actualPpm = (lelPercent / 100) * data.lel;
        
        resultDiv.style.display = 'block';
        actualSpan.innerText = actualPpm.toFixed(0);
        calcShow.innerText = `${lelPercent}% √ó ${data.lel.toLocaleString()} ppm = ${actualPpm.toFixed(0)} ppm`;
        
        // Check if concentration exceeds toxic threshold
        if(data.toxic !== "N/A" && actualPpm > data.toxic) {
            warningDiv.style.display = 'block';
            const ratio = (actualPpm / data.toxic).toFixed(1);
            warningText.innerHTML = `This concentration (${actualPpm.toFixed(0)} ppm) is <strong>${ratio}x higher</strong> than the typical toxic threshold (${data.toxic} ppm).<br>Serious health hazard even though still below explosive range!`;
        } else if(data.toxic === "N/A") {
            warningDiv.style.display = 'none';
        } else {
            warningDiv.style.display = 'block';
            warningDiv.style.background = 'rgba(0, 255, 136, 0.1)';
            warningDiv.style.borderColor = 'var(--success)';
            warningText.innerHTML = `This concentration (${actualPpm.toFixed(0)} ppm) is below the toxic threshold (${data.toxic} ppm). Still monitor closely!`;
            warningText.style.color = 'var(--success)';
        }
    }

    function checkReact() {
        const aName = document.getElementById('chemA').value;
        const bName = document.getElementById('chemB').value;
        const o = document.getElementById('reactOut');
        
        if(!aName || !bName || aName === bName) { 
            o.style.display = 'none'; 
            return; 
        }
        
        const chemA = chemicals.find(c => c.name === aName);
        const chemB = chemicals.find(c => c.name === bName);
        
        if(!chemA || !chemB) {
            o.style.display = 'none';
            return;
        }
        
        const typeA = chemA.type;
        const typeB = chemB.type;
        
        const key1 = typeA + "+" + typeB;
        const key2 = typeB + "+" + typeA;
        const hazard = reactMatrix[key1] || reactMatrix[key2];
        
        o.style.display = 'block';
        if(hazard) {
            o.innerText = hazard;
            o.className = "status-box meter-alert";
        } else {
            o.innerText = `‚úì No major incompatibility noted between ${typeA} and ${typeB}.`;
            o.className = "status-box behavior-out";
        }
    }

    function updateContainment() {
        const type = document.getElementById('containType').value;
        const resultDiv = document.getElementById('containResult');
        
        if(!type || !containmentData[type]) {
            resultDiv.style.display = 'none';
            return;
        }
        
        const data = containmentData[type];
        resultDiv.style.display = 'block';
        
        document.getElementById('containCompatible').innerHTML = data.compatible.join('<br>');
        document.getElementById('containAvoid').innerHTML = data.avoid.map(item => '‚Ä¢ ' + item).join('<br>');
        document.getElementById('containTips').innerHTML = data.tips.map(item => '‚Ä¢ ' + item).join('<br>');
    }

    /* POPULATE REACTIVITY DROPDOWNS */
    const cA = document.getElementById('chemA');
    const cB = document.getElementById('chemB');
    chemicals.forEach(c => {
        const optA = document.createElement('option');
        optA.value = c.name;
        optA.textContent = `${c.name} (${c.type})`;
        cA.appendChild(optA);
        
        const optB = document.createElement('option');
        optB.value = c.name;
        optB.textContent = `${c.name} (${c.type})`;
        cB.appendChild(optB);
    });
</script>
</body>
</html>
